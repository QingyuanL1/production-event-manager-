# GUI中执行事件操作说明

## 🚀 启动应用程序
```bash
python main.py
```

## 📋 界面导航

启动后你会看到4个标签页：
1. **控制面板** - 数据加载控制
2. **数据预览** - 查看已加载的数据
3. **事件管理** ⭐ - 创建和管理事件
4. **结果分析** - 查看处理结果

## 🎯 在事件管理中执行事件

### 第一步：切换到事件管理标签
- 点击 **"事件管理"** 标签

### 第二步：选择事件类型
在"选择事件类型"区域，从下拉菜单中选择：
- **LCA产量损失** ⭐ (我们主要测试的类型)
- 物料情况
- SBR信息  
- PM状态
- Drive loading计划

### 第三步：填写事件详细信息
选择事件类型后，系统会自动显示对应的表单字段：

#### 对于 LCA产量损失 事件：
1. **选择影响日期** - 从Daily Plan的可用日期中选择
2. **选择产线** - 选择受影响的生产线
3. **确认产品PN** - 选择产品型号
4. **已经损失的产量** - 输入数字
5. **剩余修理时间** - 输入剩余修理时间（小时）

### 第四步：提交事件
- 填写完所有必填字段后
- 点击 **"提交事件"** 按钮
- 系统会：
  1. 验证数据完整性
  2. 检查逻辑合理性
  3. 保存到SQLite数据库
  4. 显示成功消息

### 第五步：查看事件列表
在界面下方的"已登记事件列表"中可以看到：
- 事件ID
- 事件类型
- 创建时间
- 详细信息

## 🔧 事件管理操作

### 删除事件
1. 在事件列表中选中要删除的事件
2. 点击 **"删除选中事件"** 按钮
3. 确认删除

### 导出事件
1. 点击 **"导出事件列表"** 按钮
2. 选择保存位置
3. 系统会生成Excel文件

### 刷新列表
- 点击 **"刷新列表"** 按钮更新事件显示

## 🔍 LCA产能损失事件处理

当你提交LCA产能损失事件时，系统会：

### 第一步检查（当前已实现）
✅ 验证必要字段完整性  
✅ 检查损失小时数有效性  
✅ 验证Daily Plan数据存在  
✅ 确认指定日期在计划中  
✅ 验证产线存在于计划中  
✅ 检查产线有生产安排  
✅ 验证产品PN匹配

### 处理结果
- **成功**: 事件保存到数据库，准备进入第二步处理
- **结束**: 第一步检查未通过，显示具体原因

## 📊 实时反馈

### 日志区域
界面底部会显示：
- 操作日志
- 错误信息
- 成功消息
- 系统状态

### 状态提示
- ✅ 绿色 - 操作成功
- ⚠️ 黄色 - 警告信息
- ❌ 红色 - 错误信息

## 🎮 快速测试步骤

### 测试LCA产能损失事件：
1. 启动应用：`python main.py`
2. 点击"事件管理"标签
3. 选择"LCA产量损失"
4. 填写测试数据：
   - 影响日期：选择一个有效日期
   - 产线：选择如"LCA"
   - 产品PN：选择对应的产品
   - 损失产量：输入如"100"
   - 修理时间：输入如"4"
5. 点击"提交事件"
6. 查看处理结果

## 🛠️ 故障排除

### 常见问题：

**问题1**: 下拉菜单为空
- **原因**: Daily Plan数据未加载
- **解决**: 先到"控制面板"加载HSA Daily Plan数据

**问题2**: 提交失败
- **原因**: 数据验证未通过
- **解决**: 检查日志信息，确保所选数据在Daily Plan中存在

**问题3**: 事件列表不显示
- **原因**: 数据库连接问题
- **解决**: 重启应用程序，检查data目录权限

## 📱 数据持久化

- 所有事件自动保存到 `data/events.db`
- 关闭应用程序后重新打开，事件数据会自动加载
- 支持数据库备份和恢复